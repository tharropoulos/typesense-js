var qe=Object.create;var Se=Object.defineProperty;var Me=Object.getOwnPropertyDescriptor;var ke=Object.getOwnPropertyNames;var Ie=Object.getPrototypeOf,Ke=Object.prototype.hasOwnProperty;var We=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Le=(r,e)=>{for(var t in e)Se(r,t,{get:e[t],enumerable:!0})},Fe=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ke(e))!Ke.call(r,s)&&s!==t&&Se(r,s,{get:()=>e[s],enumerable:!(i=Me(e,s))||i.enumerable});return r};var je=(r,e,t)=>(t=r!=null?qe(Ie(r)):{},Fe(e||!r||!r.__esModule?Se(t,"default",{value:r,enumerable:!0}):t,r));var Te=We((xe,fe)=>{"use strict";(function(r,e){"use strict";typeof define=="function"&&define.amd?define(e):typeof fe=="object"&&fe.exports?fe.exports=e():r.log=e()})(xe,function(){"use strict";var r=function(){},e="undefined",t=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function c(l,a){var n=l[a];if(typeof n.bind=="function")return n.bind(l);try{return Function.prototype.bind.call(n,l)}catch{return function(){return Function.prototype.apply.apply(n,[l,arguments])}}}function x(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function g(l){return l==="debug"&&(l="log"),typeof console===e?!1:l==="trace"&&t?x:console[l]!==void 0?c(console,l):console.log!==void 0?c(console,"log"):r}function f(){for(var l=this.getLevel(),a=0;a<i.length;a++){var n=i[a];this[n]=a<l?r:this.methodFactory(n,l,this.name)}if(this.log=this.debug,typeof console===e&&l<this.levels.SILENT)return"No console available for logging"}function m(l){return function(){typeof console!==e&&(f.call(this),this[l].apply(this,arguments))}}function P(l,a,n){return g(l)||m.apply(this,arguments)}function R(l,a){var n=this,C,v,b,S="loglevel";typeof l=="string"?S+=":"+l:typeof l=="symbol"&&(S=void 0);function De(h){var u=(i[h]||"silent").toUpperCase();if(!(typeof window===e||!S)){try{window.localStorage[S]=u;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+u+";"}catch{}}}function be(){var h;if(!(typeof window===e||!S)){try{h=window.localStorage[S]}catch{}if(typeof h===e)try{var u=window.document.cookie,ge=encodeURIComponent(S),Ae=u.indexOf(ge+"=");Ae!==-1&&(h=/^([^;]+)/.exec(u.slice(Ae+ge.length+1))[1])}catch{}return n.levels[h]===void 0&&(h=void 0),h}}function $e(){if(!(typeof window===e||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Y(h){var u=h;if(typeof u=="string"&&n.levels[u.toUpperCase()]!==void 0&&(u=n.levels[u.toUpperCase()]),typeof u=="number"&&u>=0&&u<=n.levels.SILENT)return u;throw new TypeError("log.setLevel() called with invalid level: "+h)}n.name=l,n.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},n.methodFactory=a||P,n.getLevel=function(){return b??v??C},n.setLevel=function(h,u){return b=Y(h),u!==!1&&De(b),f.call(n)},n.setDefaultLevel=function(h){v=Y(h),be()||n.setLevel(h,!1)},n.resetLevel=function(){b=null,$e(),f.call(n)},n.enableAll=function(h){n.setLevel(n.levels.TRACE,h)},n.disableAll=function(h){n.setLevel(n.levels.SILENT,h)},n.rebuild=function(){if(o!==n&&(C=Y(o.getLevel())),f.call(n),o===n)for(var h in s)s[h].rebuild()},C=Y(o?o.getLevel():"WARN");var _e=be();_e!=null&&(b=Y(_e)),f.call(n)}o=new R,o.getLogger=function(a){if(typeof a!="symbol"&&typeof a!="string"||a==="")throw new TypeError("You must supply a name when creating a logger.");var n=s[a];return n||(n=s[a]=new R(a,o.methodFactory)),n};var y=typeof window!==e?window.log:void 0;return o.noConflict=function(){return typeof window!==e&&window.log===o&&(window.log=y),o},o.getLoggers=function(){return s},o.default=o,o})});var ze=je(Te());var ve={};Le(ve,{HTTPError:()=>T,ImportError:()=>D,MissingConfigurationError:()=>_,ObjectAlreadyExists:()=>w,ObjectNotFound:()=>A,ObjectUnprocessable:()=>E,RequestMalformed:()=>O,RequestUnauthorized:()=>N,ServerError:()=>H,TypesenseError:()=>p});var p=class extends Error{constructor(e){super(e),this.name=new.target.name,Object.setPrototypeOf(this,new.target.prototype)}};var T=class extends p{};var _=class extends p{};var w=class extends p{};var A=class extends p{};var E=class extends p{};var O=class extends p{};var N=class extends p{};var H=class extends p{};var D=class extends p{constructor(e,t){super(e),this.importResults=t}};var $=class{constructor(e){this.nodes=e.nodes||[],this.nodes=this.nodes.map(t=>this.setDefaultPathInNode(t)).map(t=>this.setDefaultPortInNode(t)).map(t=>({...t})),e.randomizeNodes==null&&(e.randomizeNodes=!0),e.randomizeNodes===!0&&this.shuffleArray(this.nodes),this.nearestNode=e.nearestNode,this.nearestNode=this.setDefaultPathInNode(this.nearestNode),this.nearestNode=this.setDefaultPortInNode(this.nearestNode),this.connectionTimeoutSeconds=e.connectionTimeoutSeconds||e.timeoutSeconds||5,this.healthcheckIntervalSeconds=e.healthcheckIntervalSeconds||60,this.numRetries=e.numRetries||this.nodes.length+(this.nearestNode==null?0:1)||3,this.retryIntervalSeconds=e.retryIntervalSeconds||.1,this.apiKey=e.apiKey,this.sendApiKeyAsQueryParam=e.sendApiKeyAsQueryParam,this.cacheSearchResultsForSeconds=e.cacheSearchResultsForSeconds||0,this.useServerSideSearchCache=e.useServerSideSearchCache||!1,this.logger=e.logger||ze,this.logLevel=e.logLevel||"warn",this.logger.setLevel(this.logLevel),this.additionalHeaders=e.additionalHeaders,this.httpAgent=e.httpAgent,this.httpsAgent=e.httpsAgent,this.paramsSerializer=e.paramsSerializer,this.showDeprecationWarnings(e),this.validate()}validate(){if(this.nodes==null||this.nodes.length===0||this.validateNodes())throw new _("Ensure that nodes[].protocol, nodes[].host and nodes[].port are set");if(this.nearestNode!=null&&this.isNodeMissingAnyParameters(this.nearestNode))throw new _("Ensure that nearestNodes.protocol, nearestNodes.host and nearestNodes.port are set");if(this.apiKey==null)throw new _("Ensure that apiKey is set");return!0}validateNodes(){return this.nodes.some(e=>this.isNodeMissingAnyParameters(e))}isNodeMissingAnyParameters(e){return!["protocol","host","port","path"].every(t=>e.hasOwnProperty(t))&&e.url==null}setDefaultPathInNode(e){return e!=null&&!e.hasOwnProperty("path")&&(e.path=""),e}setDefaultPortInNode(e){if(e!=null&&!e.hasOwnProperty("port")&&e.hasOwnProperty("protocol"))switch(e.protocol){case"https":e.port=443;break;case"http":e.port=80;break}return e}showDeprecationWarnings(e){e.timeoutSeconds&&this.logger.warn("Deprecation warning: timeoutSeconds is now renamed to connectionTimeoutSeconds"),e.masterNode&&this.logger.warn("Deprecation warning: masterNode is now consolidated to nodes, starting with Typesense Server v0.12"),e.readReplicaNodes&&this.logger.warn("Deprecation warning: readReplicaNodes is now consolidated to nodes, starting with Typesense Server v0.12")}shuffleArray(e){for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}}};import we from"axios";import{Agent as Qe}from"http";import{Agent as Je}from"https";var Be="X-TYPESENSE-API-KEY",Pe=!0,Ye=!1,U=class{constructor(e){this.configuration=e;this.apiKey=this.configuration.apiKey,this.nodes=this.configuration.nodes==null?this.configuration.nodes:JSON.parse(JSON.stringify(this.configuration.nodes)),this.nearestNode=this.configuration.nearestNode==null?this.configuration.nearestNode:JSON.parse(JSON.stringify(this.configuration.nearestNode)),this.connectionTimeoutSeconds=this.configuration.connectionTimeoutSeconds,this.healthcheckIntervalSeconds=this.configuration.healthcheckIntervalSeconds,this.numRetriesPerRequest=this.configuration.numRetries,this.retryIntervalSeconds=this.configuration.retryIntervalSeconds,this.sendApiKeyAsQueryParam=this.configuration.sendApiKeyAsQueryParam,this.additionalUserHeaders=this.configuration.additionalHeaders,this.logger=this.configuration.logger,this.initializeMetadataForNodes(),this.currentNodeIndex=-1}async get(e,t={},{abortSignal:i=null,responseType:s=void 0}={}){return this.performRequest("get",e,{queryParameters:t,abortSignal:i,responseType:s})}async delete(e,t={}){return this.performRequest("delete",e,{queryParameters:t})}async post(e,t={},i={},s={}){return this.performRequest("post",e,{queryParameters:i,bodyParameters:t,additionalHeaders:s})}async put(e,t={},i={}){return this.performRequest("put",e,{queryParameters:i,bodyParameters:t})}async patch(e,t={},i={}){return this.performRequest("patch",e,{queryParameters:i,bodyParameters:t})}async performRequest(e,t,{queryParameters:i=null,bodyParameters:s=null,additionalHeaders:o={},abortSignal:c=null,responseType:x=void 0,skipConnectionTimeout:g=!1,enableKeepAlive:f=void 0}){this.configuration.validate();let m=Date.now(),P;this.logger.debug(`Request #${m}: Performing ${e.toUpperCase()} request: ${t}`);for(let R=1;R<=this.numRetriesPerRequest+1;R++){let y=this.getNextNode(m);if(this.logger.debug(`Request #${m}: Attempting ${e.toUpperCase()} request Try #${R} to Node ${y.index}`),c&&c.aborted)return Promise.reject(new Error("Request aborted by caller."));let l;try{let a={method:e,url:this.uriFor(t,y),headers:Object.assign({},this.defaultHeaders(),o,this.additionalUserHeaders),maxContentLength:1/0,maxBodyLength:1/0,responseType:x,validateStatus:C=>C>0,transformResponse:[(C,v)=>{let b=C;return v!==void 0&&typeof C=="string"&&v["content-type"]&&v["content-type"].startsWith("application/json")&&(b=JSON.parse(C)),b}]};if(g!==!0&&(a.timeout=this.connectionTimeoutSeconds*1e3),i&&Object.keys(i).length!==0&&(a.params=i),this.sendApiKeyAsQueryParam&&(a.params=a.params||{},a.params["x-typesense-api-key"]=this.apiKey),this.configuration.httpAgent?(this.logger.debug(`Request #${m}: Using custom httpAgent`),a.httpAgent=this.configuration.httpAgent):f===!0&&(this.logger.debug(`Request #${m}: Enabling KeepAlive`),a.httpAgent=new Qe({keepAlive:!0})),this.configuration.httpsAgent?(this.logger.debug(`Request #${m}: Using custom httpsAgent`),a.httpsAgent=this.configuration.httpsAgent):f===!0&&(this.logger.debug(`Request #${m}: Enabling keepAlive`),a.httpsAgent=new Je({keepAlive:!0})),this.configuration.paramsSerializer&&(this.logger.debug(`Request #${m}: Using custom paramsSerializer`),a.paramsSerializer=this.configuration.paramsSerializer),s&&(typeof s=="string"&&s.length!==0||typeof s=="object"&&Object.keys(s).length!==0)&&(a.data=s),c){let v=we.CancelToken.source();l=()=>v.cancel(),c.addEventListener("abort",l),a.cancelToken=v.token}let n=await we(a);if(n.status>=1&&n.status<=499&&this.setNodeHealthcheck(y,Pe),this.logger.debug(`Request #${m}: Request to Node ${y.index} was made. Response Code was ${n.status}.`),n.status>=200&&n.status<300)return Promise.resolve(n.data);if(n.status<500)return Promise.reject(this.customErrorForResponse(n,n.data?.message));throw this.customErrorForResponse(n,n.data?.message)}catch(a){this.setNodeHealthcheck(y,Ye),P=a,this.logger.warn(`Request #${m}: Request to Node ${y.index} failed due to "${a.code} ${a.message}${a.response==null?"":" - "+JSON.stringify(a.response?.data)}"`),this.logger.warn(`Request #${m}: Sleeping for ${this.retryIntervalSeconds}s and then retrying request...`),await this.timer(this.retryIntervalSeconds)}finally{c&&l&&c.removeEventListener("abort",l)}}return this.logger.debug(`Request #${m}: No retries left. Raising last error`),Promise.reject(P)}getNextNode(e=0){if(this.nearestNode!=null){if(this.logger.debug(`Request #${e}: Nodes Health: Node ${this.nearestNode.index} is ${this.nearestNode.isHealthy===!0?"Healthy":"Unhealthy"}`),this.nearestNode.isHealthy===!0||this.nodeDueForHealthcheck(this.nearestNode,e))return this.logger.debug(`Request #${e}: Updated current node to Node ${this.nearestNode.index}`),this.nearestNode;this.logger.debug(`Request #${e}: Falling back to individual nodes`)}this.logger.debug(`Request #${e}: Nodes Health: ${this.nodes.map(i=>`Node ${i.index} is ${i.isHealthy===!0?"Healthy":"Unhealthy"}`).join(" || ")}`);let t=this.nodes[0];for(let i=0;i<=this.nodes.length;i++)if(this.currentNodeIndex=(this.currentNodeIndex+1)%this.nodes.length,t=this.nodes[this.currentNodeIndex],t.isHealthy===!0||this.nodeDueForHealthcheck(t,e))return this.logger.debug(`Request #${e}: Updated current node to Node ${t.index}`),t;return this.logger.debug(`Request #${e}: No healthy nodes were found. Returning the next node, Node ${t.index}`),t}nodeDueForHealthcheck(e,t=0){let i=Date.now()-e.lastAccessTimestamp>this.healthcheckIntervalSeconds*1e3;return i&&this.logger.debug(`Request #${t}: Node ${e.index} has exceeded healtcheckIntervalSeconds of ${this.healthcheckIntervalSeconds}. Adding it back into rotation.`),i}initializeMetadataForNodes(){this.nearestNode!=null&&(this.nearestNode.index="nearestNode",this.setNodeHealthcheck(this.nearestNode,Pe)),this.nodes.forEach((e,t)=>{e.index=t,this.setNodeHealthcheck(e,Pe)})}setNodeHealthcheck(e,t){e.isHealthy=t,e.lastAccessTimestamp=Date.now()}uriFor(e,t){return t.url!=null?`${t.url}${e}`:`${t.protocol}://${t.host}:${t.port}${t.path}${e}`}defaultHeaders(){let e={};return this.sendApiKeyAsQueryParam||(e[Be]=this.apiKey),e["Content-Type"]="application/json",e}async timer(e){return new Promise(t=>setTimeout(t,e*1e3))}customErrorForResponse(e,t){let i=`Request failed with HTTP code ${e.status}`;typeof t=="string"&&t.trim()!==""&&(i+=` | Server said: ${t}`);let s=new p(i);return e.status===400?s=new O(i):e.status===401?s=new N(i):e.status===404?s=new A(i):e.status===409?s=new w(i):e.status===422?s=new E(i):e.status>=500&&e.status<=599?s=new H(i):s=new T(i),s.httpStatus=e.status,s}};var Re="/collections",d=class{constructor(e){this.apiCall=e}async create(e,t={}){return this.apiCall.post(Re,e,t)}async retrieve(){return this.apiCall.get(Re)}static get RESOURCEPATH(){return Re}};var q=class{constructor(){this.responseCache=new Map;this.responsePromiseCache=new Map}clearCache(){this.responseCache=new Map,this.responsePromiseCache=new Map}async perform(e,t,i,s){let{cacheResponseForSeconds:o=120,maxSize:c=100}=s;if(o<=0||c<=0)return t.call(e,...i);let g=JSON.stringify(i),f=this.responseCache.get(g),m=Date.now();if(f){if(m-f.requestTimestamp<o*1e3)return this.responseCache.delete(g),this.responseCache.set(g,f),Promise.resolve(f.response);this.responseCache.delete(g)}let P=this.responsePromiseCache.get(g);if(P){if(m-P.requestTimestamp<o*1e3)return this.responsePromiseCache.delete(g),this.responsePromiseCache.set(g,P),P.responsePromise;this.responsePromiseCache.delete(g)}let R=t.call(e,...i);this.responsePromiseCache.set(g,{requestTimestamp:m,responsePromise:R});let y=await R;if(this.responseCache.set(g,{requestTimestamp:m,response:y}),this.responseCache.size>c){let n=this.responseCache.keys().next().value;this.responseCache.delete(n)}if(this.responsePromiseCache.size>c){let n=this.responsePromiseCache.keys().next().value;this.responsePromiseCache.delete(n)}return y}};var Ee="/documents",B=class{constructor(e,t,i){this.collectionName=e;this.apiCall=t;this.configuration=i;this.requestWithCache=new q}clearCache(){this.requestWithCache.clearCache()}async search(e,{cacheSearchResultsForSeconds:t=this.configuration.cacheSearchResultsForSeconds,abortSignal:i=null}={}){let s={};this.configuration.useServerSideSearchCache===!0&&(s.use_cache=!0);for(let c in e)Array.isArray(e[c])&&(s[c]=e[c].join(","));let o=Object.assign({},e,s);return this.requestWithCache.perform(this.apiCall,this.apiCall.get,[this.endpointPath("search"),o,{abortSignal:i}],{cacheResponseForSeconds:t})}endpointPath(e){return`${d.RESOURCEPATH}/${this.collectionName}${Ee}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return Ee}};var M=class extends B{constructor(e,t,i){super(e,t,i)}async create(e,t={}){if(!e)throw new Error("No document provided");return this.apiCall.post(this.endpointPath(),e,t)}async upsert(e,t={}){if(!e)throw new Error("No document provided");return this.apiCall.post(this.endpointPath(),e,Object.assign({},t,{action:"upsert"}))}async update(e,t={}){if(!e)throw new Error("No document provided");return t.filter_by!=null?this.apiCall.patch(this.endpointPath(),e,Object.assign({},t)):this.apiCall.post(this.endpointPath(),e,Object.assign({},t,{action:"update"}))}async delete(e={}){return this.apiCall.delete(this.endpointPath(),e)}async createMany(e,t={}){return this.configuration.logger.warn("createMany is deprecated and will be removed in a future version. Use import instead, which now takes both an array of documents or a JSONL string of documents"),this.import(e,t)}async import(e,t={}){let i;if(Array.isArray(e))try{i=e.map(o=>JSON.stringify(o)).join(`
`)}catch(o){throw o instanceof RangeError&&o.message.includes("Too many properties to enumerate")?new Error(`${o}
          It looks like you have reached a Node.js limit that restricts the number of keys in an Object: https://stackoverflow.com/questions/9282869/are-there-limits-to-the-number-of-properties-in-a-javascript-object

          Please try reducing the number of keys in your document, or using CURL to import your data.
          `):new Error(o)}else i=e;let s=await this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:t,bodyParameters:i,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0,enableKeepAlive:!0});if(Array.isArray(e)){let o=s.split(`
`).map(x=>JSON.parse(x)),c=o.filter(x=>x.success===!1);if(c.length>0)throw new D(`${o.length-c.length} documents imported successfully, ${c.length} documents failed during import. Use \`error.importResults\` from the raised exception to get a detailed error reason for each document.`,o);return o}else return s}async export(e={}){return this.apiCall.get(this.endpointPath("export"),e)}async exportStream(e={}){return this.apiCall.get(this.endpointPath("export"),e,{responseType:"stream"})}};var Ve="/overrides",k=class r{constructor(e,t){this.collectionName=e;this.apiCall=t}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${d.RESOURCEPATH}/${this.collectionName}${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return Ve}};var V=class{constructor(e,t,i){this.collectionName=e;this.overrideId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${d.RESOURCEPATH}/${this.collectionName}${k.RESOURCEPATH}/${this.overrideId}`}};var Ge="/synonyms",I=class r{constructor(e,t){this.collectionName=e;this.apiCall=t}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${d.RESOURCEPATH}/${this.collectionName}${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return Ge}};var G=class{constructor(e,t,i){this.collectionName=e;this.synonymId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${d.RESOURCEPATH}/${this.collectionName}${I.RESOURCEPATH}/${this.synonymId}`}};var ye=class{constructor(e,t,i){this.collectionName=e;this.documentId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}async update(e,t={}){return this.apiCall.patch(this.endpointPath(),e,t)}endpointPath(){return`${d.RESOURCEPATH}/${this.collectionName}${M.RESOURCEPATH}/${this.documentId}`}};var X=class{constructor(e,t,i){this.name=e;this.apiCall=t;this.configuration=i;this.individualDocuments={};this.individualOverrides={};this.individualSynonyms={};this.name=e,this.apiCall=t,this.configuration=i,this._documents=new M(this.name,this.apiCall,this.configuration),this._overrides=new k(this.name,this.apiCall),this._synonyms=new I(this.name,this.apiCall)}async retrieve(){return this.apiCall.get(this.endpointPath())}async update(e){return this.apiCall.patch(this.endpointPath(),e)}async delete(){return this.apiCall.delete(this.endpointPath())}async exists(){try{return await this.retrieve(),!0}catch(e){if(e instanceof A)return!1;throw e}}documents(e){return e?(this.individualDocuments[e]===void 0&&(this.individualDocuments[e]=new ye(this.name,e,this.apiCall)),this.individualDocuments[e]):this._documents}overrides(e){return e===void 0?this._overrides:(this.individualOverrides[e]===void 0&&(this.individualOverrides[e]=new V(this.name,e,this.apiCall)),this.individualOverrides[e])}synonyms(e){return e===void 0?this._synonyms:(this.individualSynonyms[e]===void 0&&(this.individualSynonyms[e]=new G(this.name,e,this.apiCall)),this.individualSynonyms[e])}endpointPath(){return`${d.RESOURCEPATH}/${this.name}`}};var Oe="/aliases",K=class r{constructor(e){this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(Oe)}endpointPath(e){return`${r.RESOURCEPATH}/${e}`}static get RESOURCEPATH(){return Oe}};var Z=class{constructor(e,t){this.name=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${K.RESOURCEPATH}/${this.name}`}};import{createHmac as Xe}from"crypto";var Ne="/keys",W=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(r.RESOURCEPATH,e)}async retrieve(){return this.apiCall.get(Ne)}generateScopedSearchKey(e,t){let i=JSON.stringify(t),s=Buffer.from(Xe("sha256",e).update(i).digest("base64")),o=e.substr(0,4),c=`${s}${o}${i}`;return Buffer.from(c).toString("base64")}static get RESOURCEPATH(){return Ne}};var ee=class{constructor(e,t){this.id=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${W.RESOURCEPATH}/${this.id}`}};var Ze="/debug",te=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(Ze)}};var et="/metrics.json",re=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(et)}};var tt="/stats.json",ie=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(tt)}};var rt="/health",ne=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(rt)}};var it="/operations",se=class{constructor(e){this.apiCall=e}async perform(e,t={}){return this.apiCall.post(`${it}/${e}`,{},t)}};var nt="/multi_search",L=class{constructor(e,t,i=!1){this.apiCall=e;this.configuration=t;this.useTextContentType=i;this.requestWithCache=new q}clearCache(){this.requestWithCache.clearCache()}async perform(e,t={},{cacheSearchResultsForSeconds:i=this.configuration.cacheSearchResultsForSeconds}={}){let s={};this.useTextContentType&&(s["content-type"]="text/plain");let o={};this.configuration.useServerSideSearchCache===!0&&(o.use_cache=!0);let c=Object.assign({},t,o);return this.requestWithCache.perform(this.apiCall,this.apiCall.post,[nt,e,c,s],{cacheResponseForSeconds:i})}};var st="/presets",F=class r{constructor(e){this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return st}};var oe=class{constructor(e,t){this.presetId=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${F.RESOURCEPATH}/${this.presetId}`}};var ot="/analytics/rules",j=class r{constructor(e){this.apiCall=e;this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return ot}};var ae=class{constructor(e,t){this.name=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${j.RESOURCEPATH}/${this.name}`}};var at="/analytics/events",le=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(this.endpointPath(),e)}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return at}};var lt="/analytics",ce=class{constructor(e){this.apiCall=e;this.individualAnalyticsRules={};this.apiCall=e,this._analyticsRules=new j(this.apiCall),this._analyticsEvents=new le(this.apiCall)}rules(e){return e===void 0?this._analyticsRules:(this.individualAnalyticsRules[e]===void 0&&(this.individualAnalyticsRules[e]=new ae(e,this.apiCall)),this.individualAnalyticsRules[e])}events(){return this._analyticsEvents}static get RESOURCEPATH(){return lt}};var ct="/stopwords",z=class r{constructor(e){this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return ct}};var pe=class{constructor(e,t){this.stopwordId=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${z.RESOURCEPATH}/${this.stopwordId}`}};var pt="/conversations/models",Q=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(this.endpointPath(),e)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return pt}};var he=class{constructor(e,t){this.id=e;this.apiCall=t}async update(e){return this.apiCall.put(this.endpointPath(),e)}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${Q.RESOURCEPATH}/${this.id}`}};var He="/conversations",J=class{constructor(e){this.apiCall=e;this.individualConversationModels={};this.apiCall=e,this._conversationsModels=new Q(this.apiCall)}async retrieve(){return this.apiCall.get(He)}models(e){return e===void 0?this._conversationsModels:(this.individualConversationModels[e]===void 0&&(this.individualConversationModels[e]=new he(e,this.apiCall)),this.individualConversationModels[e])}static get RESOURCEPATH(){return He}};var me=class{constructor(e,t){this.id=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async update(e){return this.apiCall.put(this.endpointPath(),e)}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${J.RESOURCEPATH}/${this.id}`}};var de=class{constructor(e){e.sendApiKeyAsQueryParam=e.sendApiKeyAsQueryParam??!1,this.configuration=new $(e),this.apiCall=new U(this.configuration),this.debug=new te(this.apiCall),this.metrics=new re(this.apiCall),this.stats=new ie(this.apiCall),this.health=new ne(this.apiCall),this.operations=new se(this.apiCall),this.multiSearch=new L(this.apiCall,this.configuration),this._collections=new d(this.apiCall),this.individualCollections={},this._aliases=new K(this.apiCall),this.individualAliases={},this._keys=new W(this.apiCall),this.individualKeys={},this._presets=new F(this.apiCall),this.individualPresets={},this._stopwords=new z(this.apiCall),this.individualStopwords={},this.analytics=new ce(this.apiCall),this._conversations=new J(this.apiCall),this.individualConversations={}}collections(e){return e===void 0?this._collections:(this.individualCollections[e]===void 0&&(this.individualCollections[e]=new X(e,this.apiCall,this.configuration)),this.individualCollections[e])}aliases(e){return e===void 0?this._aliases:(this.individualAliases[e]===void 0&&(this.individualAliases[e]=new Z(e,this.apiCall)),this.individualAliases[e])}keys(e){return e===void 0?this._keys:(this.individualKeys[e]===void 0&&(this.individualKeys[e]=new ee(e,this.apiCall)),this.individualKeys[e])}presets(e){return e===void 0?this._presets:(this.individualPresets[e]===void 0&&(this.individualPresets[e]=new oe(e,this.apiCall)),this.individualPresets[e])}stopwords(e){return e===void 0?this._stopwords:(this.individualStopwords[e]===void 0&&(this.individualStopwords[e]=new pe(e,this.apiCall)),this.individualStopwords[e])}conversations(e){return e===void 0?this._conversations:(this.individualConversations[e]===void 0&&(this.individualConversations[e]=new me(e,this.apiCall)),this.individualConversations[e])}};var Ce=class{constructor(e,t,i){this.name=e;this.apiCall=t;this.configuration=i;this._documents=new B(this.name,this.apiCall,this.configuration)}documents(){return this._documents}};var ue=class{constructor(e){e.sendApiKeyAsQueryParam=e.sendApiKeyAsQueryParam??!0,e.sendApiKeyAsQueryParam===!0&&(e.apiKey||"").length>2e3&&(console.warn("[typesense] API Key is longer than 2000 characters which is over the allowed limit, so disabling sending it as a query parameter."),e.sendApiKeyAsQueryParam=!1),this.configuration=new $(e),this.apiCall=new U(this.configuration),this.multiSearch=new L(this.apiCall,this.configuration,!0),this.individualCollections={}}clearCache(){this.multiSearch.clearCache(),Object.entries(this.individualCollections).forEach(([e,t])=>{t.documents().clearCache()})}collections(e){if(e)return this.individualCollections[e]===void 0&&(this.individualCollections[e]=new Ce(e,this.apiCall,this.configuration)),this.individualCollections[e];throw new Error("Typesense.SearchClient only supports search operations, so the collectionName that needs to be searched must be specified. Use Typesense.Client if you need to access the collection object.")}};var Xi={Client:de,SearchClient:ue,Errors:ve};export{de as Client,ve as Errors,ue as SearchClient,Xi as default};
//# sourceMappingURL=Typesense.min.mjs.map